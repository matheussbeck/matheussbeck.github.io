<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caterpillar Standard Cost Analysis - Data Engineering Portfolio</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #000000 0%, #2c2c2c 50%, #FFCD11 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.98);
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(135deg, #FFCD11 0%, #FFD700 100%);
            border-radius: 15px;
            color: #000000;
            box-shadow: 0 10px 30px rgba(255, 205, 17, 0.3);
        }

        .header .icon {
            font-size: 3rem;
            margin-bottom: 10px;
            color: #000000;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.8;
            font-weight: 500;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 8px;
            flex-wrap: wrap;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            margin: 2px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab i {
            font-size: 1rem;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #000000 0%, #2c2c2c 100%);
            color: #FFCD11;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        .nav-tab:hover:not(.active) {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            background: white;
            margin-bottom: 30px;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border-left: 4px solid #FFCD11;
        }

        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
        }

        .section h2 i {
            color: #FFCD11;
            font-size: 1.5rem;
        }

        .section h3 {
            color: #555;
            margin: 25px 0 15px 0;
            font-size: 1.3rem;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section h3 i {
            color: #FFCD11;
            font-size: 1.1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #FFCD11 0%, #FFD700 100%);
            color: #000000;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 205, 17, 0.3);
            border: 1px solid rgba(0,0,0,0.1);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(255, 205, 17, 0.4);
        }

        .stat-card i {
            font-size: 2rem;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.95rem;
            opacity: 0.9;
            font-weight: 500;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .data-table th {
            background: linear-gradient(135deg, #000000 0%, #2c2c2c 100%);
            color: #FFCD11;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .data-table td {
            padding: 12px 10px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
            font-size: 0.85rem;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
            transform: scale(1.005);
            transition: all 0.2s ease;
        }

        .positive { color: #dc3545; font-weight: bold; }
        .negative { color: #28a745; font-weight: bold; }
        .warning { color: #ffc107; font-weight: bold; }

        .methodology {
            background: linear-gradient(135deg, #FFF8DC 0%, #FFFACD 100%);
            border-left: 4px solid #FFCD11;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(255, 205, 17, 0.1);
        }

        .methodology h4 {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            color: #000000;
        }

        .methodology i {
            color: #FFCD11;
        }

        .formula {
            background: #1e1e1e;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .insight-box {
            background: linear-gradient(135deg, #FFCD11 0%, #FFD700 100%);
            border-left: 4px solid #000000;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            color: #000000;
            box-shadow: 0 4px 15px rgba(255, 205, 17, 0.2);
        }

        .insight-box h4 {
            color: #000000;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .insight-box i {
            color: #000000;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .chart-container canvas {
            max-height: 400px;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            margin: 0 2px;
        }

        .badge-success { background: #28a745; color: white; }
        .badge-danger { background: #dc3545; color: white; }
        .badge-warning { background: #FFCD11; color: #000000; }
        .badge-info { background: #2c2c2c; color: #FFCD11; }

        .footer {
            text-align: center;
            padding: 40px;
            background: #000000;
            color: #FFCD11;
            border-radius: 15px;
            margin-top: 40px;
        }

        .footer h3 {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .footer a {
            color: #FFCD11;
            text-decoration: none;
            transition: opacity 0.3s ease;
        }

        .footer a:hover {
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .nav-tab {
                margin: 2px 0;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .data-table {
                font-size: 0.75rem;
            }
            
            .data-table th,
            .data-table td {
                padding: 8px 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <i class="fas fa-cogs icon"></i>
            <h1>Caterpillar Standard Cost Analysis</h1>
            <p>Matheus Sousa Beck</p>
            <p><strong>Analysis of 3,623 records | 5 business questions | Scientific methodology applied</strong></p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('methodology')">
                <i class="fas fa-microscope"></i>
                <span>Methodology</span>
            </button>
            <button class="nav-tab" onclick="showTab('overview')">
                <i class="fas fa-chart-pie"></i>
                <span>Overview</span>
            </button>
            <button class="nav-tab" onclick="showTab('threshold')">
                <i class="fas fa-ruler"></i>
                <span>1. Threshold</span>
            </button>
            <button class="nav-tab" onclick="showTab('unit-variations')">
                <i class="fas fa-chart-line"></i>
                <span>2. Unit Variations</span>
            </button>
            <button class="nav-tab" onclick="showTab('extended-impact')">
                <i class="fas fa-dollar-sign"></i>
                <span>3. Extended Impact</span>
            </button>
            <button class="nav-tab" onclick="showTab('value-added')">
                <i class="fas fa-industry"></i>
                <span>4. Value Added</span>
            </button>
            <button class="nav-tab" onclick="showTab('outliers')">
                <i class="fas fa-search"></i>
                <span>5. Outliers & DQ</span>
            </button>
        </div>

        <!-- Methodology Tab -->
        <div id="methodology" class="tab-content active">
            <div class="section">
                <h2>
                    <i class="fas fa-microscope"></i>
                    Complete Technical Methodology
                </h2>
                
                <h3>
                    <i class="fas fa-database"></i>
                    1. Data Engineering Pipeline
                </h3>
                <div class="formula">
<pre><code class="language-python"># 1. Data Collection & Integration
df_parts = pd.read_excel(file_path, sheet_name='Part Number List')      # 3,623 records
df_procurement = pd.read_excel(file_path, sheet_name='Support_Procurement')  # 1,570 records  
df_inventory = pd.read_excel(file_path, sheet_name='Support_Inventory')      # 5,293 records
df_rates = pd.read_excel(file_path, sheet_name='Support_Rates')              # 425 records

# 2. Data Enrichment
# Text mining to identify adjustment types
commodity_keywords = ['commodity', 'material', 'steel', 'aluminum', 'copper']
freight_keywords = ['freight', 'transportation', 'surcharge', 'shipping']

# 3. Statistical Analysis
variacoes = calcular_variacoes_enriquecidas(df_enriched)
outliers = identificar_outliers_multi_layer(variacoes)</code></pre>
                </div>

                <h3>
                    <i class="fas fa-chart-line"></i>
                    2. Applied Statistical Techniques
                </h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-square-root-alt"></i>
                        <div class="stat-value">IQR</div>
                        <div class="stat-label">Interquartile Range</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-wave-square"></i>
                        <div class="stat-value">Shapiro-Wilk</div>
                        <div class="stat-label">Normality Test</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-project-diagram"></i>
                        <div class="stat-value">Pearson</div>
                        <div class="stat-label">Correlation Analysis</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-percentage"></i>
                        <div class="stat-value">Percentiles</div>
                        <div class="stat-label">Distribution Analysis</div>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-flask"></i>
                    3. Threshold Definition Methodology
                </h3>
                <div class="methodology">
                    <h4>
                        <i class="fas fa-crosshairs"></i>
                        Statistical Foundation
                    </h4>
                    <p><strong>Theoretical Foundation:</strong> I used statistical distribution analysis to establish scientifically grounded limits, avoiding arbitrary thresholds that can generate false positives or negatives.</p>
                    
                    <div class="formula">
<pre><code class="language-python"># Exclusion of extreme outliers (Data Quality Issues)
outliers_suspeitos = dados[abs(dados['variacao_pct']) > 500]
# 33 items identified as possible errors

# Percentile calculation for threshold
threshold_pct = dados_limpos['variacao_pct'].quantile(0.90)  # 11.7%
threshold_usd = dados_limpos['impacto_abs'].quantile(0.95)   # $3,714

# Final Recommendation: 12% OR $3,714
THRESHOLD = {'percentage': 12.0, 'dollar_amount': 3714}</code></pre>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-layer-group"></i>
                    4. Multi-Layer Outlier Detection
                </h3>
                <div class="formula">
<pre><code class="language-python"># Layer 1: Statistical Outliers (IQR Method)
Q1, Q3 = df.quantile([0.25, 0.75])
IQR = Q3 - Q1
outlier_threshold = Q3 + 1.5 * IQR
statistical_outliers = df[df > outlier_threshold]  # 927 outliers

# Layer 2: Business Logic Validation
data_quality_issues = df[
    (abs(df['variacao_pct']) > 500) |  # >500% variation
    ((abs(df['variacao_pct']) > 80) & (df['inventory'] > 1000))
]  # 33 possible errors

# Layer 3: Cross-Reference Validation
justified_items = df.merge(projects_db, on='part_no')</code></pre>
                </div>

                <div class="insight-box">
                    <h4>
                        <i class="fas fa-crosshairs"></i>
                        Validation Framework
                    </h4>
                    <ul>
                        <li><strong>Data Integrity:</strong> Cross-validation across multiple sheets</li>
                        <li><strong>Statistical Validity:</strong> Normality and correlation tests</li>
                        <li><strong>Business Logic:</strong> Validation with documented projects</li>
                        <li><strong>Performance:</strong> Analysis of 3,623 records in <2 seconds</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content">
            <div class="section">
                <h2>
                    <i class="fas fa-chart-pie"></i>
                    Executive Summary
                </h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-database"></i>
                        <div class="stat-value">3,623</div>
                        <div class="stat-label">Records Analyzed</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-balance-scale"></i>
                        <div class="stat-value">$39.5K</div>
                        <div class="stat-label">Net Impact</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-percentage"></i>
                        <div class="stat-value">98.5%</div>
                        <div class="stat-label">Compensation Rate</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div class="stat-value">274</div>
                        <div class="stat-label">Items without Justification</div>
                    </div>
                </div>

                <div class="insight-box">
                    <h4>
                        <i class="fas fa-lightbulb"></i>
                        Key Insight
                    </h4>
                    <p>Implementation of scientific threshold (12% OR $3,714) based on statistical percentile analysis, identifying only 13.2% of items for investigation with 57% accuracy in detecting real anomalies.</p>
                </div>

                <h3>
                    <i class="fas fa-chart-bar"></i>
                    Financial Impact Distribution
                </h3>
                <div class="chart-container">
                    <canvas id="impactDistribution"></canvas>
                </div>

                <h3>
                    <i class="fas fa-bug"></i>
                    Top Data Quality Issues
                </h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Part Number</th>
                            <th>Variation %</th>
                            <th>Impact $</th>
                            <th>Inventory</th>
                            <th>Root Cause</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>3E8082</td>
                            <td class="positive">+2,833%</td>
                            <td class="positive">$270,407</td>
                            <td>346,259</td>
                            <td><span class="badge badge-danger">Unit Conversion</span></td>
                        </tr>
                        <tr>
                            <td>5393456</td>
                            <td class="positive">+1,804%</td>
                            <td class="positive">$57,226</td>
                            <td>104</td>
                            <td><span class="badge badge-warning">Decimal Point</span></td>
                        </tr>
                        <tr>
                            <td>2663316</td>
                            <td class="positive">+1,092%</td>
                            <td class="positive">$114,304</td>
                            <td>39,283</td>
                            <td><span class="badge badge-danger">System Integration</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Threshold Tab -->
        <div id="threshold" class="tab-content">
            <div class="section">
                <h2>
                    <i class="fas fa-ruler"></i>
                    QUESTION 1: Threshold Definition
                </h2>
                
                <div class="methodology">
                    <h4>
                        <i class="fas fa-flask"></i>
                        Applied Statistical Methodology
                    </h4>
                    <p><strong>Theoretical Foundation:</strong> I used statistical distribution analysis to establish scientifically grounded limits, avoiding arbitrary thresholds.</p>
                </div>

                <h3>
                    <i class="fas fa-cogs"></i>
                    Detailed Analytical Process
                </h3>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-chart-line"></i>
                        <div class="stat-value">0.00%</div>
                        <div class="stat-label">Median (Q2)</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-sort-amount-down"></i>
                        <div class="stat-value">-2.77%</div>
                        <div class="stat-label">Q1 (25th percentile)</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-sort-amount-up"></i>
                        <div class="stat-value">11.7%</div>
                        <div class="stat-label">90th percentile</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-dollar-sign"></i>
                        <div class="stat-value">$3,714</div>
                        <div class="stat-label">95th percentile impact</div>
                    </div>
                </div>

                <div class="insight-box">
                    <h4>
                        <i class="fas fa-search"></i>
                        Choice Justification: 12% OR $3,714
                    </h4>
                    <ul>
                        <li><strong>Statistical Criterion:</strong> 90th percentile captures 90% of natural variability</li>
                        <li><strong>Materiality Criterion:</strong> 95th percentile ensures focus on relevant items</li>
                        <li><strong>Validation:</strong> 480 items flagged (13.2% of total) with 57% accuracy</li>
                    </ul>
                </div>

                <h3>
                    <i class="fas fa-chart-area"></i>
                    Variation Distribution
                </h3>
                <div class="chart-container">
                    <canvas id="thresholdChart"></canvas>
                </div>

                <h3>
                    <i class="fas fa-clipboard-check"></i>
                    Application Result
                </h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Quantity</th>
                            <th>% of Total</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Below Threshold</td>
                            <td>3,143</td>
                            <td>86.8%</td>
                            <td><span class="badge badge-success">Normal</span></td>
                        </tr>
                        <tr>
                            <td>With Justification</td>
                            <td>206</td>
                            <td>5.7%</td>
                            <td><span class="badge badge-info">Documented</span></td>
                        </tr>
                        <tr>
                            <td>Without Justification</td>
                            <td>274</td>
                            <td>7.6%</td>
                            <td><span class="badge badge-warning">Investigate</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Unit Variations Tab -->
        <div id="unit-variations" class="tab-content">
            <div class="section">
                <h2>
                    <i class="fas fa-chart-line"></i>
                    QUESTION 2: Top 20 Unit Cost Variations
                </h2>
                
                <div class="methodology">
                    <h4>
                        <i class="fas fa-sort"></i>
                        Ranking and Categorization Methodology
                    </h4>
                    <p><strong>Algorithm:</strong> Ranking by absolute value of unit variation, separating increases/decreases for balanced analysis.</p>
                </div>

                <h3>
                    <i class="fas fa-calculator"></i>
                    Statistical Analysis of Variations
                </h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-chart-bar"></i>
                        <div class="stat-value">$624.89</div>
                        <div class="stat-label">Average Variations</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-divide"></i>
                        <div class="stat-value">$425.50</div>
                        <div class="stat-label">Median Variations</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-wave-square"></i>
                        <div class="stat-value">$431.20</div>
                        <div class="stat-label">Standard Deviation</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-arrows-alt-h"></i>
                        <div class="stat-value">$1,532</div>
                        <div class="stat-label">Range</div>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-arrow-up"></i>
                    Top 20 Unit Cost Increases
                </h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Part No</th>
                            <th>Unit Variation</th>
                            <th>Variation %</th>
                            <th>Extended Impact</th>
                            <th>Inventory</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>4485690</td><td class="positive">+$1,532</td><td class="positive">+23.4%</td><td class="positive">$153,233</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>2764415</td><td class="positive">+$832</td><td class="positive">+13.2%</td><td class="positive">$83,234</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>2778210</td><td class="positive">+$816</td><td class="positive">+12.9%</td><td class="positive">$81,603</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>4485660</td><td class="positive">+$595</td><td class="positive">+11.2%</td><td class="positive">$59,541</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>5393456</td><td class="positive">+$550</td><td class="positive">+1,804%</td><td class="positive">$57,226</td><td>104</td><td><span class="badge badge-danger">Data Quality Issue</span></td></tr>
                        <tr><td>2418236</td><td class="positive">+$540</td><td class="positive">+12.0%</td><td class="positive">$53,968</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>5871041</td><td class="positive">+$341</td><td class="positive">+4.8%</td><td class="positive">$34,112</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>5871042</td><td class="positive">+$341</td><td class="positive">+4.8%</td><td class="positive">$34,112</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>4589385</td><td class="positive">+$334</td><td class="positive">+4.8%</td><td class="positive">$1,002</td><td>3</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>4589386</td><td class="positive">+$334</td><td class="positive">+4.8%</td><td class="positive">$668</td><td>2</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>5393457</td><td class="positive">+$298</td><td class="positive">+5.2%</td><td class="positive">$1,490</td><td>5</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>4285924</td><td class="positive">+$287</td><td class="positive">+1,445%</td><td class="positive">$48</td><td>7</td><td><span class="badge badge-danger">Data Quality Issue</span></td></tr>
                        <tr><td>6143785</td><td class="positive">+$268</td><td class="positive">+8.9%</td><td class="positive">$2,598</td><td>9,697</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>5896734</td><td class="positive">+$242</td><td class="positive">+17.2%</td><td class="positive">$416,356</td><td>1,720</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6367023</td><td class="positive">+$228</td><td class="positive">+7.8%</td><td class="positive">$2,124</td><td>9,312</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>5216102</td><td class="positive">+$215</td><td class="positive">+6.2%</td><td class="positive">$2,153</td><td>10,019</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>2583850</td><td class="positive">+$182</td><td class="positive">+167.9%</td><td class="positive">$22,566</td><td>12,382</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6411720</td><td class="positive">+$164</td><td class="positive">+9.8%</td><td class="positive">$16,400</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>4160737</td><td class="positive">+$156</td><td class="positive">+1,047%</td><td class="positive">$274</td><td>66</td><td><span class="badge badge-danger">Data Quality Issue</span></td></tr>
                        <tr><td>6102626</td><td class="positive">+$124</td><td class="positive">+10.6%</td><td class="positive">$34,763</td><td>280</td><td><span class="badge badge-warning">No justification</span></td></tr>
                    </tbody>
                </table>

                <h3>
                    <i class="fas fa-arrow-down"></i>
                    Top 20 Unit Cost Decreases
                </h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Part No</th>
                            <th>Unit Variation</th>
                            <th>Variation %</th>
                            <th>Extended Impact</th>
                            <th>Inventory</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>4752790</td><td class="negative">-$2,924</td><td class="negative">-15.7%</td><td class="negative">-$292,431</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6147617</td><td class="negative">-$263</td><td class="negative">-34.8%</td><td class="negative">-$9,716</td><td>37</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>4545989</td><td class="negative">-$260</td><td class="negative">-39.6%</td><td class="negative">-$26,047</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6381290</td><td class="negative">-$232</td><td class="negative">-26.7%</td><td class="negative">-$4,636</td><td>20</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6186794</td><td class="negative">-$190</td><td class="negative">-28.2%</td><td class="negative">-$6,092</td><td>32</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6276064</td><td class="negative">-$173</td><td class="negative">-26.5%</td><td class="negative">-$6,232</td><td>36</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                        <tr><td>6457580</td><td class="negative">-$159</td><td class="negative">-24.9%</td><td class="negative">-$15,933</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6321154</td><td class="negative">-$141</td><td class="negative">-23.2%</td><td class="negative">-$62,975</td><td>448</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                        <tr><td>6455552</td><td class="negative">-$128</td><td class="negative">-66.4%</td><td class="negative">-$513</td><td>4</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6261305</td><td class="negative">-$127</td><td class="negative">-26.1%</td><td class="negative">-$114,767</td><td>901</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                        <tr><td>6152975</td><td class="negative">-$125</td><td class="negative">-18.3%</td><td class="negative">-$80,625</td><td>645</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>6152972</td><td class="negative">-$119</td><td class="negative">-16.5%</td><td class="negative">-$67,354</td><td>566</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>5794348</td><td class="negative">-$118</td><td class="negative">-5.5%</td><td class="negative">-$15,114</td><td>128</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6127852</td><td class="negative">-$115</td><td class="negative">-2.8%</td><td class="negative">-$218,155</td><td>1,897</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                        <tr><td>4309930</td><td class="negative">-$113</td><td class="negative">-87.5%</td><td class="negative">-$11,342</td><td>100</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>4209905</td><td class="negative">-$105</td><td class="negative">-65.0%</td><td class="negative">-$11,764</td><td>112</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>5860202</td><td class="negative">-$94</td><td class="negative">-16.7%</td><td class="negative">-$103,024</td><td>1,096</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6043450</td><td class="negative">-$89</td><td class="negative">-75.9%</td><td class="negative">-$674,702</td><td>7,578</td><td><span class="badge badge-warning">No justification</span></td></tr>
                        <tr><td>6152974</td><td class="negative">-$85</td><td class="negative">-15.2%</td><td class="negative">-$51,000</td><td>600</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>5951962</td><td class="negative">-$81</td><td class="negative">-11.6%</td><td class="negative">-$13,095</td><td>162</td><td><span class="badge badge-warning">No justification</span></td></tr>
                    </tbody>
                </table>

                <h3>
                    <i class="fas fa-driving"></i>
                    Main Drivers Identified
                </h3>
                <div class="chart-container">
                    <canvas id="driversChart"></canvas>
                </div>

                <div class="insight-box">
                    <h4>
                        <i class="fas fa-pattern"></i>
                        Pattern Recognition
                    </h4>
                    <ul>
                        <li><strong>Freight Adjustments (40%):</strong> Supplier renegotiations without documentation</li>
                        <li><strong>Material Cost Volatility (30%):</strong> Commodity market fluctuations</li>
                        <li><strong>Data Quality Issues (20%):</strong> Suspicious variations >1000%</li>
                        <li><strong>Facility Rates (10%):</strong> Systematic changes</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Extended Impact Tab -->
        <div id="extended-impact" class="tab-content">
            <div class="section">
                <h2>
                    <i class="fas fa-dollar-sign"></i>
                    QUESTION 3: Top 20 Extended Impact Variations
                </h2>
                
                <div class="methodology">
                    <h4>
                        <i class="fas fa-weight"></i>
                        Weighted Impact Methodology
                    </h4>
                    <div class="formula">
<pre><code class="language-python">Extended_Impact = Unit_Variation × Current_Inventory_Units

# Pearson Correlation
correlation = np.corrcoef(unit_variation, extended_impact)[0,1]
# Result: 0.73 (strong but not perfect correlation)</code></pre>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-chart-pie"></i>
                    Concentration Analysis (Pareto)
                </h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-medal"></i>
                        <div class="stat-value">54%</div>
                        <div class="stat-label">Top 5 = % of Total Impact</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-trophy"></i>
                        <div class="stat-value">78%</div>
                        <div class="stat-label">Top 10 = % of Total Impact</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-crown"></i>
                        <div class="stat-value">87%</div>
                        <div class="stat-label">Top 25% = % of Impact</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-balance-scale"></i>
                        <div class="stat-value">98.5%</div>
                        <div class="stat-label">Compensation Rate</div>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-arrow-up"></i>
                    Top 20 Extended Impact Increases
                </h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Part No</th>
                            <th>Unit Var</th>
                            <th>Extended Impact</th>
                            <th>Inventory</th>
                            <th>Var %</th>
                            <th>Driver</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>5896734</td><td>+$242</td><td class="positive">$416,356</td><td>1,720</td><td>+17.2%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>3E8082</td><td>+$0.78</td><td class="positive">$270,407</td><td>346,259</td><td>+2,833%</td><td>Data Quality</td><td><span class="badge badge-danger">Error Suspect</span></td></tr>
                        <tr><td>4485690</td><td>+$1,532</td><td class="positive">$153,233</td><td>100</td><td>+23.4%</td><td>Freight</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>2663316</td><td>+$2.91</td><td class="positive">$114,304</td><td>39,283</td><td>+1,092%</td><td>Data Quality</td><td><span class="badge badge-danger">Error Suspect</span></td></tr>
                        <tr><td>2764415</td><td>+$832</td><td class="positive">$83,234</td><td>100</td><td>+13.2%</td><td>Freight</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>2778210</td><td>+$816</td><td class="positive">$81,603</td><td>100</td><td>+12.9%</td><td>Freight</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>4485660</td><td>+$595</td><td class="positive">$59,541</td><td>100</td><td>+11.2%</td><td>Freight</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>5393456</td><td>+$550</td><td class="positive">$57,226</td><td>104</td><td>+1,804%</td><td>Data Quality</td><td><span class="badge badge-danger">Error Suspect</span></td></tr>
                        <tr><td>2418236</td><td>+$540</td><td class="positive">$53,968</td><td>100</td><td>+12.0%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>5667784</td><td>+$22</td><td class="positive">$48,599</td><td>2,227</td><td>+10.5%</td><td>Material</td><td><span class="badge badge-success">Freight adjustment</span></td></tr>
                        <tr><td>5859717</td><td>+$40</td><td class="positive">$39,615</td><td>979</td><td>+41.5%</td><td>Material</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>5860101</td><td>+$27</td><td class="positive">$38,410</td><td>1,405</td><td>+17.9%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>6102626</td><td>+$8</td><td class="positive">$34,763</td><td>4,096</td><td>+10.6%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>5696756</td><td>+$125</td><td class="positive">$34,463</td><td>276</td><td>+533.5%</td><td>Data Quality</td><td><span class="badge badge-danger">Error Suspect</span></td></tr>
                        <tr><td>5871041</td><td>+$341</td><td class="positive">$34,112</td><td>100</td><td>+4.8%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>5871042</td><td>+$341</td><td class="positive">$34,112</td><td>100</td><td>+4.8%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>6312296</td><td>+$28</td><td class="positive">$30,908</td><td>1,096</td><td>+3.3%</td><td>Value Added</td><td><span class="badge badge-info">Systematic</span></td></tr>
                        <tr><td>5696757</td><td>+$65</td><td class="positive">$26,894</td><td>411</td><td>+192.3%</td><td>Data Quality</td><td><span class="badge badge-danger">Error Suspect</span></td></tr>
                        <tr><td>4759529</td><td>+$43</td><td class="positive">$23,396</td><td>547</td><td>+299.7%</td><td>Data Quality</td><td><span class="badge badge-danger">Error Suspect</span></td></tr>
                        <tr><td>3801770</td><td>+$227</td><td class="positive">$22,732</td><td>100</td><td>+9.6%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                    </tbody>
                </table>

                <h3>
                    <i class="fas fa-arrow-down"></i>
                    Top 20 Extended Impact Decreases
                </h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Part No</th>
                            <th>Unit Var</th>
                            <th>Extended Impact</th>
                            <th>Inventory</th>
                            <th>Var %</th>
                            <th>Driver</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>4752790</td><td>-$2,924</td><td class="negative">-$292,431</td><td>100</td><td>-15.7%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>5859644</td><td>-$42</td><td class="negative">-$270,946</td><td>6,448</td><td>-94.3%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>6229710</td><td>-$0.51</td><td class="negative">-$199,499</td><td>390,878</td><td>-93.4%</td><td>Value Added</td><td><span class="badge badge-danger">High volume</span></td></tr>
                        <tr><td>6043450</td><td>-$19</td><td class="negative">-$144,150</td><td>7,578</td><td>-75.9%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>6261305</td><td>-$127</td><td class="negative">-$114,767</td><td>901</td><td>-26.1%</td><td>Material</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                        <tr><td>6127852</td><td>-$40</td><td class="negative">-$75,940</td><td>1,897</td><td>-2.8%</td><td>Material</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                        <tr><td>6321154</td><td>-$141</td><td class="negative">-$62,975</td><td>448</td><td>-23.2%</td><td>Material</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                        <tr><td>6152975</td><td>-$64</td><td class="negative">-$41,247</td><td>645</td><td>-16.3%</td><td>Material</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>6152972</td><td>-$67</td><td class="negative">-$38,155</td><td>566</td><td>-16.5%</td><td>Material</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>5860202</td><td>-$30</td><td class="negative">-$33,235</td><td>1,096</td><td>-16.7%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>6432399</td><td>-$14</td><td class="negative">-$31,872</td><td>2,240</td><td>-16.7%</td><td>Material</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>6078456</td><td>-$14</td><td class="negative">-$31,016</td><td>2,228</td><td>-22.3%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>4209781</td><td>-$2</td><td class="negative">-$30,548</td><td>13,279</td><td>-16.3%</td><td>Material</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>5995965</td><td>-$40</td><td class="negative">-$30,344</td><td>758</td><td>-2.8%</td><td>Material</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                        <tr><td>6144794</td><td>-$14</td><td class="negative">-$27,200</td><td>2,005</td><td>-71.8%</td><td>Material</td><td><span class="badge badge-success">Commodity</span></td></tr>
                        <tr><td>9X2092</td><td>-$0.07</td><td class="negative">-$26,808</td><td>358,064</td><td>-83.5%</td><td>Value Added</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>4545989</td><td>-$260</td><td class="negative">-$26,047</td><td>100</td><td>-39.6%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>5649313</td><td>-$16</td><td class="negative">-$25,142</td><td>1,564</td><td>-17.5%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>6028427</td><td>-$17</td><td class="negative">-$24,849</td><td>1,424</td><td>-20.3%</td><td>Material</td><td><span class="badge badge-warning">Investigate</span></td></tr>
                        <tr><td>5929924</td><td>-$16</td><td class="negative">-$23,896</td><td>1,514</td><td>-15.5%</td><td>Material</td><td><span class="badge badge-success">Commodity+Freight</span></td></tr>
                    </tbody>
                </table>

                <h3>
                    <i class="fas fa-chart-area"></i>
                    Volume vs Variation Analysis
                </h3>
                <div class="chart-container">
                    <canvas id="volumeVariationChart"></canvas>
                </div>

                <div class="insight-box">
                    <h4>
                        <i class="fas fa-sitemap"></i>
                        Strategic Segmentation
                    </h4>
                    <ul>
                        <li><strong>High Volume + Low Unit Variation:</strong> 6229710 (-$199k, -93%, 390k units) → Risk: Data quality in high volume</li>
                        <li><strong>Low Volume + High Unit Variation:</strong> 4485690 (+$153k, +23%, 100 units) → Risk: Possible pricing error</li>
                        <li><strong>Correlation:</strong> 73% between unit variation and extended impact indicates that high unit variations don't always generate the highest impacts</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Value Added Tab -->
        <div id="value-added" class="tab-content">
            <div class="section">
                <h2>
                    <i class="fas fa-industry"></i>
                    QUESTION 4: Value Added Analysis
                </h2>
                
                <div class="methodology">
                    <h4>
                        <i class="fas fa-calendar-alt"></i>
                        Year-over-Year Analytical Decomposition
                    </h4>
                    <div class="formula">
<pre><code class="language-python"># Facility Rates Changes (Systematic)
Variable_Receiving: 0.061 → 0.043 = -29.5%
Period_Receiving:   0.086 → 0.104 = +20.9%  
General_Overhead:   0.051 → 0.050 = -2.0%

# Value Added Total = Variable + Period + General
value_added_impact = sum(component_impacts)  # $68,645</code></pre>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-plus-circle"></i>
                    Total Value Added Impact: +$68,645
                </h3>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-divide"></i>
                        <div class="stat-value">-0.3%</div>
                        <div class="stat-label">Median Variation</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-chart-bar"></i>
                        <div class="stat-value">+11.4%</div>
                        <div class="stat-label">Average Variation</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-dollar-sign"></i>
                        <div class="stat-value">$68,645</div>
                        <div class="stat-label">Total Impact</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-cubes"></i>
                        <div class="stat-value">3</div>
                        <div class="stat-label">Components</div>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-chart-area"></i>
                    Component Evolution
                </h3>
                <div class="chart-container">
                    <canvas id="valueAddedChart"></canvas>
                </div>

                <div class="insight-box">
                    <h4>
                        <i class="fas fa-chart-line"></i>
                        Statistical Interpretation
                    </h4>
                    <ul>
                        <li><strong>Variable Receiving:</strong> p-value < 0.05 (Non-normal) ← Concentration at -29%</li>
                        <li><strong>Period Receiving:</strong> p-value < 0.05 (Non-normal) ← Concentration at +21%</li>
                        <li><strong>General Overhead:</strong> p-value < 0.05 (Non-normal) ← Concentration at -2%</li>
                        <li><strong>Conclusion:</strong> Concentrated distributions confirm systematic facility rate changes</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Outliers Tab -->
        <div id="outliers" class="tab-content">
            <div class="section">
                <h2>
                    <i class="fas fa-search"></i>
                    QUESTION 5: Outliers and Data Inconsistencies
                </h2>
                
                <div class="methodology">
                    <h4>
                        <i class="fas fa-layer-group"></i>
                        Multi-Layer Detection Methodology
                    </h4>
                    <div class="formula">
<pre><code class="language-python"># Layer 1: Statistical Outliers (IQR Method)
Q1, Q3 = df.quantile([0.25, 0.75])
IQR = Q3 - Q1
outlier_threshold = Q3 + 1.5 * IQR
statistical_outliers = df[df > outlier_threshold]  # 927 outliers

# Layer 2: Business Logic Validation
data_quality_issues = df[
    (abs(df['variacao_pct']) > 500) |  # >500% variation
    ((abs(df['variacao_pct']) > 80) & (df['inventory'] > 1000))
]  # 33 possible errors

# Layer 3: Cross-Reference Validation
justified_items = df.merge(projects_db, on='part_no')</code></pre>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-bug"></i>
                    Data Quality Issues Identified: 33 items
                </h3>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-exchange-alt"></i>
                        <div class="stat-value">15</div>
                        <div class="stat-label">Unit Conversion Errors</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-decimal"></i>
                        <div class="stat-value">8</div>
                        <div class="stat-label">Decimal Point Issues</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-network-wired"></i>
                        <div class="stat-value">10</div>
                        <div class="stat-label">System Integration</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-dollar-sign"></i>
                        <div class="stat-value">$441K</div>
                        <div class="stat-label">Total DQ Impact</div>
                    </div>
                </div>

                <h3>
                    <i class="fas fa-chart-area"></i>
                    Criticality Matrix
                </h3>
                <div class="chart-container">
                    <canvas id="criticalityMatrix"></canvas>
                </div>

                <div class="insight-box">
                    <h4>
                        <i class="fas fa-tools"></i>
                        Structured Correction Recommendations
                    </h4>
                    <h5>Immediate (0-30 days):</h5>
                    <ul>
                        <li>Manually validate top 10 outliers (>$50k impact)</li>
                        <li>Implement data validation rules</li>
                        <li>Cross-check with supplier master data</li>
                    </ul>
                    <h5>Medium Term (30-90 days):</h5>
                    <ul>
                        <li>Automated outlier detection system</li>
                        <li>Master data governance process</li>
                        <li>Supplier data integration review</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="footer">
            <h3>
                <i class="fas fa-cogs"></i>
                Caterpillar Business Case
            </h3>
            <p>Complete Statistical Analysis of Standard Cost Variations</p>
            <p>Technologies used: Python, Pandas, NumPy, SciPy, Matplotlib, Statistical Analysis</p>
            <p>Methodology: Multi-layer validation, IQR outlier detection, Percentile-based thresholds</p>
            </a></p>
        </div>
    </div>

    <script>
        // Tab Functionality
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to selected tab
            event.target.closest('.nav-tab').classList.add('active');
        }

        // Chart Configurations
        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    font: {
                        size: 16,
                        weight: 'bold'
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        };

        // Impact Distribution Chart
        const impactCtx = document.getElementById('impactDistribution').getContext('2d');
        new Chart(impactCtx, {
            type: 'bar',
            data: {
                labels: ['>$50k', '$10k-$50k', '$5k-$10k', '$1k-$5k', '-$1k to $1k', '-$5k to -$1k', '-$10k to -$5k', '<-$10k'],
                datasets: [{
                    label: 'Number of Items',
                    data: [9, 33, 31, 148, 3165, 156, 42, 39],
                    backgroundColor: [
                        '#dc3545', '#FFCD11', '#FFD700', '#FFF8DC',
                        '#000000', '#2c2c2c', '#FFCD11', '#dc3545'
                    ]
                }]
            },
            options: {
                ...chartOptions,
                plugins: {
                    ...chartOptions.plugins,
                    title: {
                        ...chartOptions.plugins.title,
                        text: 'Financial Impact Distribution'
                    }
                }
            }
        });

        // Threshold Chart
        const thresholdCtx = document.getElementById('thresholdChart').getContext('2d');
        new Chart(thresholdCtx, {
            type: 'line',
            data: {
                labels: ['Q1 (-2.77%)', 'Median (0%)', 'Q3 (0%)', '90th percentile (11.7%)', '95th percentile (15.2%)'],
                datasets: [{
                    label: 'Variation Percentiles',
                    data: [-2.77, 0, 0, 11.7, 15.2],
                    borderColor: '#FFCD11',
                    backgroundColor: 'rgba(255, 205, 17, 0.1)',
                    tension: 0.4,
                    fill: true
                }, {
                    label: 'Chosen Threshold (12%)',
                    data: [12, 12, 12, 12, 12],
                    borderColor: '#000000',
                    borderDash: [5, 5],
                    pointRadius: 0
                }]
            },
            options: {
                ...chartOptions,
                plugins: {
                    ...chartOptions.plugins,
                    title: {
                        ...chartOptions.plugins.title,
                        text: 'Percentile Analysis for Threshold Definition'
                    }
                }
            }
        });

        // Drivers Chart with Data Labels
        const driversCtx = document.getElementById('driversChart').getContext('2d');
        new Chart(driversCtx, {
            type: 'pie',
            data: {
                labels: ['Freight Adjustments', 'Material Cost Volatility', 'Data Quality Issues', 'Facility Rates'],
                datasets: [{
                    data: [40, 30, 20, 10],
                    backgroundColor: ['#FFCD11', '#000000', '#dc3545', '#cccccc'],
                    borderWidth: 3,
                    borderColor: '#ffffff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Main Unit Cost Variation Drivers',
                        font: {
                            size: 16,
                            weight: 'bold'
                        }
                    },
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 20,
                            usePointStyle: true,
                            font: {
                                size: 12,
                                weight: '500'
                            },
                            generateLabels: function(chart) {
                                const data = chart.data;
                                return data.labels.map((label, i) => ({
                                    text: `${label} (${data.datasets[0].data[i]}%)`,
                                    fillStyle: data.datasets[0].backgroundColor[i],
                                    index: i
                                }));
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.parsed;
                                return `${label}: ${value}%`;
                            }
                        }
                    }
                }
            }
        });

        // Volume Variation Chart with larger bubbles
        const volumeCtx = document.getElementById('volumeVariationChart').getContext('2d');
        new Chart(volumeCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'High Impact',
                    data: [
                        {x: 1720, y: 17.2, r: 55},
                        {x: 346259, y: 2833, r: 65},
                        {x: 100, y: 23.4, r: 50},
                        {x: 39283, y: 1092, r: 60}
                    ],
                    backgroundColor: 'rgba(220, 53, 69, 0.7)'
                }, {
                    label: 'Medium Impact',
                    data: [
                        {x: 2227, y: 10.5, r: 45},
                        {x: 100, y: 13.2, r: 45},
                        {x: 100, y: 12.9, r: 45}
                    ],
                    backgroundColor: 'rgba(255, 205, 17, 0.7)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Volume × Variation % × Extended Impact',
                        font: {
                            size: 16,
                            weight: 'bold'
                        }
                    }
                },
                scales: {
                    x: {
                        type: 'logarithmic',
                        title: {
                            display: true,
                            text: 'Inventory Units (log scale)'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Variation %'
                        }
                    }
                }
            }
        });

        // Value Added Chart
        const valueAddedCtx = document.getElementById('valueAddedChart').getContext('2d');
        new Chart(valueAddedCtx, {
            type: 'bar',
            data: {
                labels: ['Variable Receiving', 'Period Receiving', 'General Overhead'],
                datasets: [{
                    label: '2024 Rates',
                    data: [0.061, 0.086, 0.051],
                    backgroundColor: 'rgba(44, 44, 44, 0.8)'
                }, {
                    label: '2025 Rates',
                    data: [0.043, 0.104, 0.050],
                    backgroundColor: 'rgba(255, 205, 17, 0.8)'
                }]
            },
            options: {
                ...chartOptions,
                plugins: {
                    ...chartOptions.plugins,
                    title: {
                        ...chartOptions.plugins.title,
                        text: 'Facility Rates Evolution (2024 vs 2025)'
                    }
                }
            }
        });

        // Criticality Matrix with larger bubbles
        const criticalityCtx = document.getElementById('criticalityMatrix').getContext('2d');
        new Chart(criticalityCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Unit Conversion Errors',
                    data: [
                        {x: 18.027, y: 3, r: 55}
                    ],
                    backgroundColor: 'rgba(220, 53, 69, 0.8)'
                }, {
                    label: 'Decimal Point Issues',
                    data: [
                        {x: 7.153, y: 2, r: 50}
                    ],
                    backgroundColor: 'rgba(255, 205, 17, 0.8)'
                }, {
                    label: 'System Integration',
                    data: [
                        {x: 1.204, y: 2, r: 45}
                    ],
                    backgroundColor: 'rgba(44, 44, 44, 0.8)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Criticality Matrix: Impact vs Urgency',
                        font: {
                            size: 16,
                            weight: 'bold'
                        }
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Average Impact (x $1000,00)'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Urgency (1=Low, 2=Medium, 3=High)'
                        },
                        min: 1,
                        max: 3
                    }
                }
            }
        });
    </script>
</body>
</html>